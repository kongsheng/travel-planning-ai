   # ðŸš€ æœåŠ¡å™¨éƒ¨ç½²å®Œæ•´æ“ä½œæ‰‹å†Œ

## æœåŠ¡å™¨ä¿¡æ¯
```
å…¬ç½‘IP: 49.235.101.226
ç”¨æˆ·å: ubuntu
å¯†ç : [ä½ è®¾ç½®çš„å¯†ç ]
ç³»ç»Ÿ: Ubuntu 20.04 LTS
```

---

## ðŸ“¦ ç¬¬ä¸€æ­¥ï¼šæŽ¨é€ä»£ç åˆ° GitHubï¼ˆæœ¬åœ°æ“ä½œï¼‰

### 1. åˆå§‹åŒ– Git å¹¶æäº¤ä»£ç 

åœ¨æœ¬åœ°é¡¹ç›®ç›®å½•ï¼ˆPowerShellï¼‰æ‰§è¡Œï¼š

```powershell
# å·²ç»æ‰§è¡Œè¿‡ git initï¼Œè·³è¿‡

# åˆ›å»º .gitignore æ–‡ä»¶
@"
node_modules/
backend/node_modules/
backend/.env
.env.local
.env.production
dist/
.DS_Store
*.log
"@ | Out-File -FilePath .gitignore -Encoding utf8

# æ·»åŠ æ‰€æœ‰æ–‡ä»¶
git add .

# æäº¤
git commit -m "Initial commit - Travel Planning AI"
```

### 2. åˆ›å»º GitHub ä»“åº“

1. è®¿é—®ï¼šhttps://github.com/new
2. ä»“åº“åï¼š`travel-planning-ai`
3. è®¾ç½®ä¸º **Public**ï¼ˆå…¬å¼€ï¼‰
4. **ä¸è¦**å‹¾é€‰ "Add a README file"
5. ç‚¹å‡» **"Create repository"**

### 3. æŽ¨é€ä»£ç åˆ° GitHub

GitHub ä¼šæ˜¾ç¤ºå‘½ä»¤ï¼Œæˆ–è€…æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```powershell
# æ·»åŠ è¿œç¨‹ä»“åº“ï¼ˆæ›¿æ¢æˆä½ çš„ GitHub ç”¨æˆ·åï¼‰
git remote add origin https://github.com/ä½ çš„ç”¨æˆ·å/travel-planning-ai.git

# æŽ¨é€ä»£ç 
git branch -M main
git push -u origin main
```

å¦‚æžœæç¤ºè¾“å…¥ç”¨æˆ·åå¯†ç ï¼š
- ç”¨æˆ·åï¼šä½ çš„ GitHub ç”¨æˆ·å
- å¯†ç ï¼šä½¿ç”¨ Personal Access Tokenï¼ˆä¸æ˜¯ç™»å½•å¯†ç ï¼‰
  - èŽ·å– Tokenï¼šhttps://github.com/settings/tokens
  - ç‚¹å‡» "Generate new token (classic)"
  - å‹¾é€‰ "repo" æƒé™
  - ç”ŸæˆåŽå¤åˆ¶ Token ä½œä¸ºå¯†ç ä½¿ç”¨

---

## ðŸ” ç¬¬äºŒæ­¥ï¼šè¿žæŽ¥åˆ°æœåŠ¡å™¨

### 1. ä½¿ç”¨ PowerShell è¿žæŽ¥

```powershell
# è¿žæŽ¥å‘½ä»¤
ssh ubuntu@49.235.101.226

# é¦–æ¬¡è¿žæŽ¥ä¼šæç¤ºæ˜¯å¦ä¿¡ä»»ï¼Œè¾“å…¥ yes
# ç„¶åŽè¾“å…¥ä½ è®¾ç½®çš„å¯†ç 
```

### 2. å¦‚æžœè¿žæŽ¥å¤±è´¥

æ£€æŸ¥ï¼š
- é˜²ç«å¢™æ˜¯å¦å¼€æ”¾ 22 ç«¯å£ï¼ˆSSHï¼‰
- å¯†ç æ˜¯å¦æ­£ç¡®
- æœåŠ¡å™¨æ˜¯å¦æ­£åœ¨è¿è¡Œ

---

## ðŸ› ï¸ ç¬¬ä¸‰æ­¥ï¼šæœåŠ¡å™¨ç«¯éƒ¨ç½²ï¼ˆè‡ªåŠ¨è„šæœ¬ï¼‰

### æ–¹æ³•Aï¼šä¸€é”®è‡ªåŠ¨éƒ¨ç½²ï¼ˆæŽ¨èï¼‰

è¿žæŽ¥åˆ°æœåŠ¡å™¨åŽï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
# 1. ä¸‹è½½éƒ¨ç½²è„šæœ¬
wget -O deploy.sh https://raw.githubusercontent.com/kongsheng/travel-planning-ai/main/deploy-to-server.sh

# å¦‚æžœ wget ä¸‹è½½å¤±è´¥ï¼Œæ‰‹åŠ¨åˆ›å»ºè„šæœ¬
nano deploy.sh
# ç„¶åŽæŠŠä¸‹é¢çš„è„šæœ¬å†…å®¹å¤åˆ¶è¿›åŽ»ï¼ŒæŒ‰ Ctrl+O ä¿å­˜ï¼ŒCtrl+X é€€å‡º

# 2. èµ‹äºˆæ‰§è¡Œæƒé™
chmod +x deploy.sh

# 3. è¿è¡Œéƒ¨ç½²è„šæœ¬
bash deploy.sh
```

### æ–¹æ³•Bï¼šæ‰‹åŠ¨éƒ¨ç½²ï¼ˆè¯¦ç»†æ­¥éª¤ï¼‰

å¦‚æžœè‡ªåŠ¨è„šæœ¬å‡ºé—®é¢˜ï¼ŒæŒ‰ä»¥ä¸‹æ­¥éª¤æ‰‹åŠ¨éƒ¨ç½²ï¼š

#### æ­¥éª¤1ï¼šæ›´æ–°ç³»ç»Ÿ
```bash
sudo apt update && sudo apt upgrade -y
```

#### æ­¥éª¤2ï¼šå®‰è£… Node.js 18
```bash
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt install -y nodejs
node -v  # éªŒè¯å®‰è£…
npm -v
```

#### æ­¥éª¤3ï¼šå®‰è£… PM2
```bash
sudo npm install -g pm2
```

#### æ­¥éª¤4ï¼šå®‰è£… Nginx
```bash
sudo apt install -y nginx
```

#### æ­¥éª¤5ï¼šå…‹éš†é¡¹ç›®
```bash
cd ~
git clone https://github.com/ä½ çš„ç”¨æˆ·å/travel-planning-ai.git
cd travel-planning-ai
```

#### æ­¥éª¤6ï¼šé…ç½®åŽç«¯
```bash
cd backend

# åˆ›å»ºçŽ¯å¢ƒå˜é‡æ–‡ä»¶
cat > .env << 'EOF'
ZHIPU_API_KEY=ä½ çš„æ™ºè°±APIå¯†é’¥
ZHIPU_API_URL=https://open.bigmodel.cn/api/paas/v4/chat/completions
PEXELS_API_KEY=
PORT=3001
NODE_ENV=production
EOF

# ç¼–è¾‘å¡«å…¥çœŸå®žçš„ API Key
nano .env
# ä¿®æ”¹ ZHIPU_API_KEY é‚£ä¸€è¡Œ
# Ctrl+O ä¿å­˜ï¼ŒCtrl+X é€€å‡º

# å®‰è£…ä¾èµ–
npm install --production

# å¯åŠ¨åŽç«¯
pm2 start server.js --name travel-backend
pm2 save
pm2 startup
```

#### æ­¥éª¤7ï¼šæž„å»ºå‰ç«¯
```bash
cd ~/travel-planning-ai

# åˆ›å»ºç”Ÿäº§çŽ¯å¢ƒé…ç½®
echo "VITE_BACKEND_URL=http://localhost:3001" > .env.production

# å®‰è£…ä¾èµ–
npm install

# æž„å»º
npm run build

# éƒ¨ç½²åˆ° Nginx
sudo rm -rf /var/www/html/*
sudo cp -r dist/* /var/www/html/
```

#### æ­¥éª¤8ï¼šé…ç½® Nginx
```bash
sudo nano /etc/nginx/sites-available/default
```

åˆ é™¤æ‰€æœ‰å†…å®¹ï¼Œæ›¿æ¢ä¸ºï¼š
```nginx
server {
    listen 80;
    server_name _;

    location / {
        root /var/www/html;
        index index.html;
        try_files $uri $uri/ /index.html;
    }

    location /api {
        proxy_pass http://localhost:3001;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_cache_bypass $http_upgrade;
    }

    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_types text/plain text/css text/xml text/javascript application/x-javascript application/xml+rss application/json;
}
```

ä¿å­˜å¹¶é€€å‡ºï¼ˆCtrl+Oï¼ŒEnterï¼ŒCtrl+Xï¼‰

#### æ­¥éª¤9ï¼šé‡å¯ Nginx
```bash
sudo nginx -t  # æµ‹è¯•é…ç½®
sudo systemctl restart nginx
```

#### æ­¥éª¤10ï¼šé…ç½®é˜²ç«å¢™
```bash
sudo ufw allow 22/tcp
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw --force enable
```

---

## âœ… ç¬¬å››æ­¥ï¼šæµ‹è¯•è®¿é—®

### 1. æ‰“å¼€æµè§ˆå™¨
è®¿é—®ï¼šhttp://49.235.101.226

### 2. æµ‹è¯•ç”Ÿæˆè¡Œç¨‹
- ç›®çš„åœ°ï¼šåŒ—äº¬
- æ—¥æœŸï¼š2025-10-28
- å¤©æ•°ï¼š3
- ç±»åž‹ï¼šå®¶åº­æ¸¸
- ç‚¹å‡»"å¼€å§‹è§„åˆ’"

### 3. æ£€æŸ¥æœåŠ¡çŠ¶æ€
```bash
# æŸ¥çœ‹åŽç«¯çŠ¶æ€
pm2 status

# æŸ¥çœ‹åŽç«¯æ—¥å¿—
pm2 logs travel-backend

# æŸ¥çœ‹ Nginx çŠ¶æ€
sudo systemctl status nginx
```

---

## ðŸ”„ åŽç»­æ›´æ–°éƒ¨ç½²

### æœ¬åœ°ä¿®æ”¹ä»£ç åŽï¼š

```powershell
# 1. æäº¤ä»£ç 
git add .
git commit -m "æ›´æ–°åŠŸèƒ½"
git push
```

### æœåŠ¡å™¨ç«¯æ›´æ–°ï¼š

```bash
# 1. SSH ç™»å½•æœåŠ¡å™¨
ssh ubuntu@49.235.101.226

# 2. æ‰§è¡Œæ›´æ–°
cd ~/travel-planning-ai
git pull

# 3. æ›´æ–°åŽç«¯
cd backend
npm install
pm2 restart travel-backend

# 4. æ›´æ–°å‰ç«¯
cd ..
npm install
npm run build
sudo cp -r dist/* /var/www/html/

echo "âœ… æ›´æ–°å®Œæˆï¼"
```

### æˆ–è€…åˆ›å»ºå¿«æ·æ›´æ–°è„šæœ¬ï¼š

```bash
# åˆ›å»ºæ›´æ–°è„šæœ¬
cat > ~/update.sh << 'EOF'
#!/bin/bash
cd ~/travel-planning-ai
git pull
cd backend
npm install
pm2 restart travel-backend
cd ..
npm install
npm run build
sudo cp -r dist/* /var/www/html/
echo "âœ… æ›´æ–°å®Œæˆï¼"
EOF

chmod +x ~/update.sh

# ä»¥åŽæ›´æ–°åªéœ€æ‰§è¡Œï¼š
~/update.sh
```

---

## ðŸ“Š å¸¸ç”¨å‘½ä»¤

### æŸ¥çœ‹æœåŠ¡çŠ¶æ€
```bash
# åŽç«¯æœåŠ¡
pm2 status
pm2 logs travel-backend
pm2 restart travel-backend
pm2 stop travel-backend

# Nginx
sudo systemctl status nginx
sudo systemctl restart nginx
sudo systemctl stop nginx
sudo systemctl start nginx

# ç³»ç»Ÿèµ„æº
free -h        # å†…å­˜
df -h          # ç£ç›˜
htop           # CPUå’Œè¿›ç¨‹ï¼ˆéœ€å®‰è£…ï¼šsudo apt install htopï¼‰
```

### æŸ¥çœ‹æ—¥å¿—
```bash
# åŽç«¯æ—¥å¿—
pm2 logs travel-backend

# Nginx è®¿é—®æ—¥å¿—
sudo tail -f /var/log/nginx/access.log

# Nginx é”™è¯¯æ—¥å¿—
sudo tail -f /var/log/nginx/error.log

# ç³»ç»Ÿæ—¥å¿—
sudo journalctl -xe
```

### æ–‡ä»¶æ“ä½œ
```bash
# æŸ¥çœ‹æ–‡ä»¶
cat æ–‡ä»¶å
less æ–‡ä»¶å

# ç¼–è¾‘æ–‡ä»¶
nano æ–‡ä»¶å

# æŸ¥çœ‹ç›®å½•
ls -la

# è¿›å…¥ç›®å½•
cd ç›®å½•å

# è¿”å›žä¸Šçº§ç›®å½•
cd ..

# è¿”å›žä¸»ç›®å½•
cd ~
```

---

## ðŸ†˜ å¸¸è§é—®é¢˜æŽ’æŸ¥

### 1. æ— æ³•è®¿é—®ç½‘ç«™
```bash
# æ£€æŸ¥ Nginx
sudo systemctl status nginx
sudo nginx -t

# æ£€æŸ¥åŽç«¯
pm2 status
pm2 logs travel-backend

# æ£€æŸ¥é˜²ç«å¢™
sudo ufw status

# æ£€æŸ¥ç«¯å£å ç”¨
sudo netstat -tlnp | grep 80
sudo netstat -tlnp | grep 3001
```

### 2. åŽç«¯ API è°ƒç”¨å¤±è´¥
```bash
# æŸ¥çœ‹åŽç«¯æ—¥å¿—
pm2 logs travel-backend

# æ£€æŸ¥çŽ¯å¢ƒå˜é‡
cat ~/travel-planning-ai/backend/.env

# é‡å¯åŽç«¯
pm2 restart travel-backend
```

### 3. 502 Bad Gateway
```bash
# åŽç«¯æ²¡æœ‰å¯åŠ¨
pm2 start ~/travel-planning-ai/backend/server.js --name travel-backend

# æ£€æŸ¥ç«¯å£
curl http://localhost:3001/api/health
```

### 4. å†…å­˜ä¸è¶³
```bash
# æ·»åŠ  Swap
sudo fallocate -l 2G /swapfile
sudo chmod 600 /swapfile
sudo mkswap /swapfile
sudo swapon /swapfile
echo '/swapfile none swap sw 0 0' | sudo tee -a /etc/fstab
```

---

## ðŸŽ¯ ä¸‹ä¸€æ­¥ä¼˜åŒ–

### 1. ç»‘å®šåŸŸåï¼ˆå¯é€‰ï¼‰

å¦‚æžœä½ æœ‰åŸŸåï¼Œå¯ä»¥ç»‘å®šï¼š

```bash
# ç¼–è¾‘ Nginx é…ç½®
sudo nano /etc/nginx/sites-available/default

# ä¿®æ”¹ server_name
server_name ä½ çš„åŸŸå.com www.ä½ çš„åŸŸå.com;

# é‡å¯ Nginx
sudo systemctl restart nginx
```

### 2. é…ç½® HTTPSï¼ˆæŽ¨èï¼‰

```bash
# å®‰è£… Certbot
sudo apt install -y certbot python3-certbot-nginx

# è‡ªåŠ¨é…ç½® HTTPS
sudo certbot --nginx -d ä½ çš„åŸŸå.com

# è‡ªåŠ¨ç»­æœŸ
sudo crontab -e
# æ·»åŠ ï¼š0 3 * * * certbot renew --quiet
```

### 3. è®¾ç½®ç›‘æŽ§

ä½¿ç”¨ UptimeRobot å…è´¹ç›‘æŽ§ï¼š
1. æ³¨å†Œï¼šhttps://uptimerobot.com/
2. æ·»åŠ ç›‘æŽ§ï¼šhttp://49.235.101.226
3. è®¾ç½®é€šçŸ¥é‚®ç®±

---

## ðŸ“ž éœ€è¦å¸®åŠ©ï¼Ÿ

é‡åˆ°é—®é¢˜æ—¶ï¼š
1. æŸ¥çœ‹é”™è¯¯æ—¥å¿—ï¼ˆ`pm2 logs` æˆ– `/var/log/nginx/error.log`ï¼‰
2. æ£€æŸ¥æœåŠ¡çŠ¶æ€ï¼ˆ`pm2 status` å’Œ `systemctl status nginx`ï¼‰
3. æŠŠé”™è¯¯ä¿¡æ¯å‘Šè¯‰æˆ‘ï¼Œæˆ‘ä¼šå¸®ä½ è§£å†³

**ç¥ä½ éƒ¨ç½²é¡ºåˆ©ï¼ðŸŽ‰**
