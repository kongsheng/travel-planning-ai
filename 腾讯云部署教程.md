# ðŸš€ è…¾è®¯äº‘è½»é‡æœåŠ¡å™¨éƒ¨ç½²æ•™ç¨‹ï¼ˆè¶…è¯¦ç»†ï¼‰

## ðŸ“‹ å‡†å¤‡å·¥ä½œ

### 1. è´­ä¹°æœåŠ¡å™¨ï¼ˆÂ¥50/å¹´ï¼‰

#### æ­¥éª¤ï¼š
1. è®¿é—®ï¼šhttps://cloud.tencent.com/act/pro/lighthousespecial
2. é€‰æ‹©é…ç½®ï¼š
   ```
   å¥—é¤ï¼š1æ ¸2G 50GB 4Må¸¦å®½
   åœ°åŸŸï¼šä¸Šæµ·/å¹¿å·ž/åŒ—äº¬ï¼ˆé€‰ç¦»ä½ è¿‘çš„ï¼‰
   é•œåƒï¼šUbuntu 20.04 LTS
   æ—¶é•¿ï¼š1å¹´
   ä»·æ ¼ï¼šÂ¥50ï¼ˆæ–°ç”¨æˆ·ï¼‰
   ```
3. ç‚¹å‡»"ç«‹å³è´­ä¹°"ï¼Œå®Œæˆæ”¯ä»˜

#### è´­ä¹°åŽè®°å½•ä¿¡æ¯ï¼š
```
å…¬ç½‘IPï¼šxxx.xxx.xxx.xxxï¼ˆåœ¨æŽ§åˆ¶å°æŸ¥çœ‹ï¼‰
ç”¨æˆ·åï¼šubuntuï¼ˆé»˜è®¤ï¼‰
å¯†ç ï¼šéœ€è¦åœ¨æŽ§åˆ¶å°é‡ç½®
```

### 2. é‡ç½®å¯†ç ï¼ˆé¦–æ¬¡ä½¿ç”¨å¿…é¡»ï¼‰

1. è¿›å…¥è…¾è®¯äº‘æŽ§åˆ¶å°ï¼šhttps://console.cloud.tencent.com/lighthouse/instance
2. æ‰¾åˆ°ä½ çš„æœåŠ¡å™¨
3. ç‚¹å‡»"é‡ç½®å¯†ç "
4. è®¾ç½®æ–°å¯†ç ï¼ˆå»ºè®®ï¼šå¤§å°å†™å­—æ¯+æ•°å­—+ç¬¦å·ï¼Œä¾‹å¦‚ï¼šAa123456!ï¼‰
5. é‡å¯æœåŠ¡å™¨

### 3. é…ç½®é˜²ç«å¢™è§„åˆ™

åœ¨è…¾è®¯äº‘æŽ§åˆ¶å°ï¼š
1. ç‚¹å‡»æœåŠ¡å™¨ â†’ "é˜²ç«å¢™"
2. æ·»åŠ è§„åˆ™ï¼š
   ```
   åº”ç”¨ç±»åž‹    åè®®ç«¯å£    æ¥æº
   HTTP(80)    TCP:80      0.0.0.0/0
   HTTPS(443)  TCP:443     0.0.0.0/0
   SSH(22)     TCP:22      0.0.0.0/0
   ```
3. ä¿å­˜

---

## ðŸ” ç¬¬ä¸€æ­¥ï¼šè¿žæŽ¥åˆ°æœåŠ¡å™¨

### Windows ç”¨æˆ·ï¼š

#### æ–¹æ³•1ï¼šä½¿ç”¨ PowerShellï¼ˆæŽ¨èï¼‰
```powershell
# æ‰“å¼€ PowerShellï¼Œè¾“å…¥
ssh ubuntu@ä½ çš„æœåŠ¡å™¨IP

# ä¾‹å¦‚
ssh ubuntu@123.456.789.012

# è¾“å…¥å¯†ç ï¼ˆå¯†ç ä¸æ˜¾ç¤ºï¼Œæ­£å¸¸è¾“å…¥åŽæŒ‰ Enterï¼‰
```

#### æ–¹æ³•2ï¼šä½¿ç”¨è…¾è®¯äº‘ç½‘é¡µæŽ§åˆ¶å°
1. ç™»å½•è…¾è®¯äº‘æŽ§åˆ¶å°
2. ç‚¹å‡»æœåŠ¡å™¨ â†’ "ç™»å½•"
3. é€‰æ‹©"ä½¿ç”¨ VNC ç™»å½•"

### Mac/Linux ç”¨æˆ·ï¼š
```bash
ssh ubuntu@ä½ çš„æœåŠ¡å™¨IP
```

---

## ðŸ“¦ ç¬¬äºŒæ­¥ï¼šæŽ¨é€ä»£ç åˆ° GitHubï¼ˆæœ¬åœ°æ“ä½œï¼‰

### 1. åˆå§‹åŒ– Gitï¼ˆå¦‚æžœè¿˜æ²¡æœ‰ï¼‰
```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
cd i:\shopProject\comyui\travel-planning-ai

# åˆå§‹åŒ– Git
git init

# æ·»åŠ  .gitignore
echo "node_modules/" > .gitignore
echo "backend/node_modules/" >> .gitignore
echo "backend/.env" >> .gitignore
echo ".env.local" >> .gitignore
echo "dist/" >> .gitignore

# æ·»åŠ æ‰€æœ‰æ–‡ä»¶
git add .

# æäº¤
git commit -m "Initial commit"
```

### 2. åˆ›å»º GitHub ä»“åº“
1. è®¿é—® https://github.com/new
2. ä»“åº“åï¼š`travel-planning-ai`
3. é€‰æ‹© `Public`ï¼ˆå…¬å¼€ï¼‰æˆ– `Private`ï¼ˆç§æœ‰ï¼‰
4. ç‚¹å‡» "Create repository"

### 3. æŽ¨é€ä»£ç 
```bash
# æ·»åŠ è¿œç¨‹ä»“åº“ï¼ˆæ›¿æ¢æˆä½ çš„ç”¨æˆ·åï¼‰
git remote add origin https://github.com/ä½ çš„ç”¨æˆ·å/travel-planning-ai.git

# æŽ¨é€ä»£ç 
git branch -M main
git push -u origin main
```

---

## ðŸš€ ç¬¬ä¸‰æ­¥ï¼šæœåŠ¡å™¨ç«¯éƒ¨ç½²

### æ–¹æ³•1ï¼šä½¿ç”¨è‡ªåŠ¨è„šæœ¬ï¼ˆæŽ¨èï¼Œæœ€ç®€å•ï¼‰

#### 1. è¿žæŽ¥æœåŠ¡å™¨
```bash
ssh ubuntu@ä½ çš„æœåŠ¡å™¨IP
```

#### 2. ä¸‹è½½å¹¶è¿è¡Œéƒ¨ç½²è„šæœ¬
```bash
# ä¸‹è½½è„šæœ¬
wget https://raw.githubusercontent.com/ä½ çš„ç”¨æˆ·å/travel-planning-ai/main/deploy-to-server.sh

# èµ‹äºˆæ‰§è¡Œæƒé™
chmod +x deploy-to-server.sh

# ä½†æ˜¯éœ€è¦å…ˆä¿®æ”¹è„šæœ¬ä¸­çš„ GitHub åœ°å€ï¼
nano deploy-to-server.sh

# æ‰¾åˆ°è¿™ä¸€è¡Œï¼š
# git clone https://github.com/ä½ çš„ç”¨æˆ·å/travel-planning-ai.git
# æ”¹æˆä½ çš„å®žé™… GitHub åœ°å€

# ä¿å­˜ï¼ˆCtrl+Oï¼ŒEnterï¼‰å¹¶é€€å‡ºï¼ˆCtrl+Xï¼‰

# è¿è¡Œè„šæœ¬
bash deploy-to-server.sh
```

è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
- âœ… å®‰è£… Node.jsã€PM2ã€Nginx
- âœ… å…‹éš†ä»£ç 
- âœ… å®‰è£…ä¾èµ–
- âœ… æž„å»ºå‰ç«¯
- âœ… å¯åŠ¨æœåŠ¡

#### 3. é…ç½® API Key
```bash
# ç¼–è¾‘çŽ¯å¢ƒå˜é‡æ–‡ä»¶
nano ~/travel-planning-ai/backend/.env

# ä¿®æ”¹è¿™ä¸€è¡Œï¼š
ZHIPU_API_KEY=ä½ çš„æ™ºè°±APIå¯†é’¥

# ä¿å­˜ï¼ˆCtrl+Oï¼ŒEnterï¼‰å¹¶é€€å‡ºï¼ˆCtrl+Xï¼‰

# é‡å¯åŽç«¯æœåŠ¡
pm2 restart travel-backend
```

---

### æ–¹æ³•2ï¼šæ‰‹åŠ¨éƒ¨ç½²ï¼ˆé€‚åˆå­¦ä¹ ï¼‰

#### 1. æ›´æ–°ç³»ç»Ÿ
```bash
sudo apt update && sudo apt upgrade -y
```

#### 2. å®‰è£… Node.js 18
```bash
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt install -y nodejs

# éªŒè¯å®‰è£…
node -v  # åº”è¯¥æ˜¾ç¤º v18.x.x
npm -v
```

#### 3. å®‰è£… PM2
```bash
sudo npm install -g pm2
```

#### 4. å®‰è£… Nginx
```bash
sudo apt install -y nginx
```

#### 5. å…‹éš†é¡¹ç›®
```bash
cd ~
git clone https://github.com/ä½ çš„ç”¨æˆ·å/travel-planning-ai.git
cd travel-planning-ai
```

#### 6. é…ç½®åŽç«¯
```bash
cd backend

# åˆ›å»ºçŽ¯å¢ƒå˜é‡æ–‡ä»¶
cat > .env << EOF
ZHIPU_API_KEY=ä½ çš„æ™ºè°±APIå¯†é’¥
PORT=3001
NODE_ENV=production
EOF

# å®‰è£…ä¾èµ–
npm install --production

# å¯åŠ¨æœåŠ¡
pm2 start server.js --name travel-backend
pm2 save
pm2 startup
```

#### 7. æž„å»ºå‰ç«¯
```bash
cd ..

# åˆ›å»ºç”Ÿäº§çŽ¯å¢ƒé…ç½®
echo "VITE_BACKEND_URL=http://localhost:3001" > .env.production

# å®‰è£…ä¾èµ–å¹¶æž„å»º
npm install
npm run build

# éƒ¨ç½²åˆ° Nginx
sudo rm -rf /var/www/html/*
sudo cp -r dist/* /var/www/html/
```

#### 8. é…ç½® Nginx
```bash
sudo nano /etc/nginx/sites-available/default
```

æ›¿æ¢ä¸ºä»¥ä¸‹å†…å®¹ï¼š
```nginx
server {
    listen 80;
    server_name _;

    # å‰ç«¯é™æ€æ–‡ä»¶
    location / {
        root /var/www/html;
        index index.html;
        try_files $uri $uri/ /index.html;
    }

    # åŽç«¯APIä»£ç†
    location /api {
        proxy_pass http://localhost:3001;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_cache_bypass $http_upgrade;
    }

    # å¯ç”¨åŽ‹ç¼©
    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_types text/plain text/css text/xml text/javascript application/x-javascript application/xml+rss application/json;
}
```

ä¿å­˜å¹¶é€€å‡ºï¼ˆCtrl+Oï¼ŒEnterï¼ŒCtrl+Xï¼‰

#### 9. é‡å¯ Nginx
```bash
sudo nginx -t  # æµ‹è¯•é…ç½®
sudo systemctl restart nginx
```

#### 10. é…ç½®é˜²ç«å¢™
```bash
sudo ufw allow 22/tcp
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw --force enable
```

---

## âœ… ç¬¬å››æ­¥ï¼šæµ‹è¯•è®¿é—®

### 1. æ‰“å¼€æµè§ˆå™¨
```
http://ä½ çš„æœåŠ¡å™¨IP
```

### 2. æµ‹è¯•ç”Ÿæˆè¡Œç¨‹
- ç›®çš„åœ°ï¼šåŒ—äº¬
- æ—¥æœŸï¼š2025-10-28
- å¤©æ•°ï¼š3
- ç±»åž‹ï¼šå®¶åº­æ¸¸
- ç‚¹å‡»"å¼€å§‹è§„åˆ’"

### 3. æ£€æŸ¥æœåŠ¡çŠ¶æ€
```bash
# æŸ¥çœ‹åŽç«¯è¿è¡ŒçŠ¶æ€
pm2 status

# æŸ¥çœ‹åŽç«¯æ—¥å¿—
pm2 logs travel-backend

# æŸ¥çœ‹ Nginx çŠ¶æ€
sudo systemctl status nginx
```

---

## ðŸ”„ åŽç»­æ›´æ–°éƒ¨ç½²

å½“ä½ ä¿®æ”¹ä»£ç åŽï¼Œéœ€è¦é‡æ–°éƒ¨ç½²ï¼š

### 1. æœ¬åœ°æŽ¨é€ä»£ç 
```bash
# åœ¨æœ¬åœ°é¡¹ç›®ç›®å½•
git add .
git commit -m "æ›´æ–°åŠŸèƒ½"
git push
```

### 2. æœåŠ¡å™¨ç«¯æ›´æ–°
```bash
# SSH ç™»å½•æœåŠ¡å™¨
ssh ubuntu@ä½ çš„æœåŠ¡å™¨IP

# æ‹‰å–æœ€æ–°ä»£ç 
cd ~/travel-planning-ai
git pull

# æ›´æ–°åŽç«¯
cd backend
npm install
pm2 restart travel-backend

# æ›´æ–°å‰ç«¯
cd ..
npm install
npm run build
sudo cp -r dist/* /var/www/html/
```

### æˆ–è€…ä½¿ç”¨å¿«æ·è„šæœ¬ï¼š
```bash
# åˆ›å»ºæ›´æ–°è„šæœ¬
cat > ~/update.sh << 'EOF'
#!/bin/bash
cd ~/travel-planning-ai
git pull
cd backend
npm install
pm2 restart travel-backend
cd ..
npm install
npm run build
sudo cp -r dist/* /var/www/html/
echo "âœ… æ›´æ–°å®Œæˆï¼"
EOF

chmod +x ~/update.sh

# ä»¥åŽæ›´æ–°åªéœ€è¿è¡Œï¼š
~/update.sh
```

---

## ðŸŒ ï¼ˆå¯é€‰ï¼‰é…ç½®åŸŸåå’Œ HTTPS

### 1. è´­ä¹°åŸŸå
- é˜¿é‡Œäº‘ï¼šhttps://wanwang.aliyun.com/
- è…¾è®¯äº‘ï¼šhttps://dnspod.cloud.tencent.com/
- ä»·æ ¼ï¼šÂ¥30-50/å¹´ï¼ˆ.com åŸŸåï¼‰

### 2. åŸŸåè§£æž
åœ¨åŸŸåæŽ§åˆ¶å°æ·»åŠ  A è®°å½•ï¼š
```
ä¸»æœºè®°å½•ï¼š@ï¼ˆæˆ– wwwï¼‰
è®°å½•ç±»åž‹ï¼šA
è®°å½•å€¼ï¼šä½ çš„æœåŠ¡å™¨IP
TTLï¼š600
```

### 3. å®‰è£… SSL è¯ä¹¦ï¼ˆå…è´¹ï¼‰
```bash
# å®‰è£… Certbot
sudo apt install -y certbot python3-certbot-nginx

# è‡ªåŠ¨é…ç½® HTTPS
sudo certbot --nginx -d ä½ çš„åŸŸå.com

# æŒ‰æç¤ºè¾“å…¥é‚®ç®±ï¼ŒåŒæ„åè®®
```

è‡ªåŠ¨ç»­æœŸï¼ˆè¯ä¹¦90å¤©æœ‰æ•ˆï¼‰ï¼š
```bash
# æµ‹è¯•ç»­æœŸ
sudo certbot renew --dry-run

# æ·»åŠ å®šæ—¶ä»»åŠ¡ï¼ˆæ¯å¤©æ£€æŸ¥ï¼‰
sudo crontab -e

# æ·»åŠ è¿™ä¸€è¡Œ
0 3 * * * certbot renew --quiet
```

---

## ðŸ“Š ç›‘æŽ§å’Œç»´æŠ¤

### 1. æŸ¥çœ‹æœåŠ¡å™¨èµ„æº
```bash
# å†…å­˜ä½¿ç”¨
free -h

# ç£ç›˜ä½¿ç”¨
df -h

# CPU å’Œè¿›ç¨‹
htop  # éœ€è¦å…ˆå®‰è£…ï¼šsudo apt install htop
```

### 2. æŸ¥çœ‹æ—¥å¿—
```bash
# åŽç«¯æ—¥å¿—
pm2 logs travel-backend

# Nginx è®¿é—®æ—¥å¿—
sudo tail -f /var/log/nginx/access.log

# Nginx é”™è¯¯æ—¥å¿—
sudo tail -f /var/log/nginx/error.log
```

### 3. è®¾ç½®æ—¥å¿—è½®è½¬ï¼ˆé˜²æ­¢æ—¥å¿—æ–‡ä»¶è¿‡å¤§ï¼‰
```bash
pm2 install pm2-logrotate
pm2 set pm2-logrotate:max_size 10M
pm2 set pm2-logrotate:retain 7
```

---

## âš ï¸ å¸¸è§é—®é¢˜

### Q1: æ— æ³•è®¿é—®ç½‘ç«™ï¼Ÿ
```bash
# æ£€æŸ¥ Nginx
sudo systemctl status nginx

# æ£€æŸ¥åŽç«¯
pm2 status

# æ£€æŸ¥é˜²ç«å¢™
sudo ufw status

# æ£€æŸ¥è…¾è®¯äº‘æŽ§åˆ¶å°çš„é˜²ç«å¢™è§„åˆ™
```

### Q2: 502 Bad Gatewayï¼Ÿ
```bash
# åŽç«¯å¯èƒ½æ²¡æœ‰å¯åŠ¨
pm2 restart travel-backend

# æŸ¥çœ‹åŽç«¯æ—¥å¿—
pm2 logs travel-backend
```

### Q3: API è°ƒç”¨å¤±è´¥ï¼Ÿ
```bash
# æ£€æŸ¥çŽ¯å¢ƒå˜é‡
cat ~/travel-planning-ai/backend/.env

# ç¡®è®¤ API Key æ­£ç¡®
# æ£€æŸ¥æ™ºè°± API ä½™é¢
```

### Q4: å†…å­˜ä¸è¶³ï¼Ÿ
```bash
# æ·»åŠ  Swap äº¤æ¢ç©ºé—´ï¼ˆä¸´æ—¶æ‰©å®¹ï¼‰
sudo fallocate -l 2G /swapfile
sudo chmod 600 /swapfile
sudo mkswap /swapfile
sudo swapon /swapfile

# æ°¸ä¹…ç”Ÿæ•ˆ
echo '/swapfile none swap sw 0 0' | sudo tee -a /etc/fstab
```

### Q5: æœåŠ¡å™¨é‡å¯åŽæœåŠ¡æ²¡æœ‰è‡ªåŠ¨å¯åŠ¨ï¼Ÿ
```bash
# è®¾ç½® PM2 å¼€æœºè‡ªå¯
pm2 startup
pm2 save

# è®¾ç½® Nginx å¼€æœºè‡ªå¯
sudo systemctl enable nginx
```

---

## ðŸ’° æˆæœ¬æ€»ç»“

```
æœåŠ¡å™¨ï¼šÂ¥50/å¹´ï¼ˆæ–°ç”¨æˆ·ï¼‰æˆ– Â¥108/å¹´ï¼ˆç»­è´¹ï¼‰
åŸŸåï¼šÂ¥30-50/å¹´ï¼ˆå¯é€‰ï¼‰
SSLè¯ä¹¦ï¼šå…è´¹ï¼ˆLet's Encryptï¼‰

æ€»è®¡ï¼šÂ¥50-158/å¹´
å¹³å‡æ¯æœˆï¼šÂ¥4-13

æ¯”ç‚¹ä¸€æ¯å¥¶èŒ¶è¿˜ä¾¿å®œï¼
```

---

## ðŸŽ¯ ä¸‹ä¸€æ­¥

éƒ¨ç½²æˆåŠŸåŽï¼Œä½ å¯ä»¥ï¼š
1. âœ… å¼€å§‹æŽ¨å¹¿ï¼ˆå°çº¢ä¹¦/æŠ–éŸ³/çŸ¥ä¹Žï¼‰
2. âœ… æ”¶é›†ç”¨æˆ·åé¦ˆ
3. âœ… æ·»åŠ ä»˜è´¹åŠŸèƒ½
4. âœ… æŽ¥å…¥å¹¿å‘Šå’Œè¿”ä½£

**ç¥ä½ éƒ¨ç½²é¡ºåˆ©ï¼Œæ—©æ—¥å®žçŽ°ç›ˆåˆ©ï¼ðŸŽ‰**
