# 🚀 免费部署指南（0成本上线）

## 方案概览

```
前端（React）→ Vercel（免费，永久）
后端（Node.js）→ Render（免费，750小时/月）
总成本：0元
```

---

## 📦 第一步：部署后端到 Render

### 1. 注册 Render 账号
访问：https://render.com/
- 用 GitHub 账号登录（推荐）

### 2. 连接 GitHub 仓库
1. 在 Render 控制台点击 "New +"
2. 选择 "Web Service"
3. 连接你的 GitHub 仓库
4. 选择 `backend` 目录

### 3. 配置部署参数
```
Name: travel-planning-backend
Environment: Node
Region: Singapore（新加坡，离中国最近）
Branch: main
Build Command: npm install
Start Command: npm start
```

### 4. 添加环境变量
点击 "Advanced" → "Add Environment Variable"
```
ZHIPU_API_KEY = 你的智谱API密钥
PEXELS_API_KEY = 你的Pexels密钥（可选）
PORT = 3001
NODE_ENV = production
```

### 5. 选择免费计划
- Instance Type: Free
- 点击 "Create Web Service"

### 6. 等待部署完成（约3-5分钟）
部署成功后，你会得到一个地址：
```
https://travel-planning-backend.onrender.com
```

⚠️ **重要：复制这个地址，后面要用！**

---

## 🌐 第二步：部署前端到 Vercel

### 1. 修改前端API地址

编辑 `src/services/llmService.js`：

```javascript
const API_CONFIG = {
  // 改成你的 Render 后端地址
  endpoint: 'https://你的后端地址.onrender.com/api/generate-trip',
  // 或者用环境变量
  endpoint: import.meta.env.VITE_BACKEND_URL || 'http://localhost:3001/api/generate-trip',
};
```

### 2. 创建环境变量文件

创建 `.env.production`：
```env
VITE_BACKEND_URL=https://你的后端地址.onrender.com
```

### 3. 注册 Vercel 账号
访问：https://vercel.com/
- 用 GitHub 账号登录

### 4. 导入项目
1. 点击 "Add New Project"
2. 选择你的 GitHub 仓库
3. 配置项目：
   ```
   Framework Preset: Vite
   Root Directory: ./
   Build Command: npm run build
   Output Directory: dist
   ```

### 5. 添加环境变量
在 "Environment Variables" 中添加：
```
VITE_BACKEND_URL = https://你的后端地址.onrender.com
```

### 6. 部署
点击 "Deploy"，等待1-2分钟

部署成功后得到地址：
```
https://你的项目名.vercel.app
```

---

## ✅ 第三步：测试

### 1. 访问前端地址
```
https://你的项目名.vercel.app
```

### 2. 填写表单测试
- 目的地：北京
- 日期：2025-10-28
- 天数：3
- 类型：家庭游

### 3. 检查是否正常生成行程

---

## ⚠️ 注意事项

### Render 免费版限制：
- ✅ 750小时/月运行时间（够用）
- ⚠️ 15分钟无请求会自动休眠
- ⚠️ 唤醒需要3-5秒（首次访问慢）
- ✅ 每月50GB流量（够用）

### 解决休眠问题：
#### 方法1：添加定时唤醒（推荐）

使用免费的 Cron-Job.org：
1. 注册：https://cron-job.org/
2. 创建任务：
   ```
   URL: https://你的后端地址.onrender.com/api/health
   间隔：每10分钟
   ```

#### 方法2：改用付费版（$7/月）
- 永不休眠
- 更多资源

---

## 🎯 后续优化

### 1. 绑定自定义域名（可选）

**前端（Vercel）：**
1. 购买域名（阿里云/腾讯云，约¥30/年）
2. 在 Vercel 项目设置中添加域名
3. 配置 DNS 解析

**后端（Render）：**
免费版不支持自定义域名

### 2. 添加 CDN 加速

使用 Cloudflare（免费）：
1. 注册：https://cloudflare.com/
2. 添加网站
3. 配置 DNS
4. 开启缓存和压缩

### 3. 性能监控

使用 UptimeRobot（免费）：
- 监控网站可用性
- 自动唤醒休眠的服务

---

## 💰 成本对比

| 方案 | 前端 | 后端 | 月成本 | 年成本 |
|------|------|------|--------|--------|
| **免费方案** | Vercel | Render | ¥0 | ¥0 |
| **稳定方案** | Vercel | Render付费 | ¥50 | ¥600 |
| **自建方案** | Vercel | 阿里云ECS | ¥10 | ¥120 |

---

## 🆘 常见问题

### Q1: 后端休眠怎么办？
A: 使用 Cron-Job.org 每10分钟唤醒一次

### Q2: 流量不够用怎么办？
A: Render 免费版 50GB/月，一般够用。不够就升级付费版

### Q3: 想要更稳定怎么办？
A: 买最便宜的服务器（腾讯云¥50/年新用户）

### Q4: 如何监控运行状态？
A: 使用 UptimeRobot 免费监控

### Q5: HTTPS 证书怎么办？
A: Vercel 和 Render 都自动配置 HTTPS，无需操心

---

## 📞 部署遇到问题？

常见错误：
1. **502 Bad Gateway** → 检查后端环境变量是否正确
2. **CORS 错误** → 检查后端 CORS 配置
3. **API 调用失败** → 检查前端的后端地址是否正确
4. **智谱 API 报错** → 检查 API Key 和余额

---

## 🎉 部署成功后

1. ✅ 在小红书/抖音分享你的网站链接
2. ✅ 收集用户反馈
3. ✅ 根据数据优化产品
4. ✅ 开始准备盈利功能

**祝你部署顺利！🚀**
