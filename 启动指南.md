# 🚀 完整启动指南

## 📦 第一步：安装后端依赖

```bash
cd backend
npm install
```

## 🔑 第二步：配置 API Key

编辑 `backend/.env` 文件：

```env
# 智谱清言 API（必需）
ZHIPU_API_KEY=你的智谱API密钥

# 百度 API（可选，目前使用预设图片）
BAIDU_API_KEY=你的百度API密钥
BAIDU_SECRET_KEY=你的百度密钥

PORT=3001
```

### 获取智谱清言 API Key：
1. 访问：https://open.bigmodel.cn/
2. 注册账号
3. 创建 API Key
4. 新用户有免费额度

## 🎯 第三步：启动后端服务

```bash
cd backend
npm start
```

看到以下输出表示成功：
```
🚀 旅行规划后端服务已启动
📍 地址: http://localhost:3001
🤖 智谱AI: ✅ 已配置
等待前端请求...
```

## 🌐 第四步：启动前端

打开新终端：

```bash
# 回到项目根目录
cd ..

# 启动前端
npm run dev
```

## ✨ 第五步：测试

1. 打开浏览器访问前端地址（通常是 http://localhost:5173）
2. 填写表单：
   - 目的地：北京
   - 日期：2025-10-28
   - 天数：7
   - 类型：家庭游
3. 点击"开始规划"
4. 查看生成的行程（带真实地标图片！）

## 🔍 流程说明

```
前端表单提交
    ↓
localhost:3001/api/generate-trip
    ↓
调用智谱清言 API 生成行程
    ↓
根据城市名称获取真实图片
    ↓
返回完整数据（含真实图片）
    ↓
前端展示行程
```

## 🖼️ 图片来源

- **北京**: 故宫真实照片
- **上海**: 外滩真实照片  
- **酒店**: 高质量酒店照片
- **其他城市**: 通用城市风景

## ⚠️ 注意事项

1. **必须先启动后端**，再启动前端
2. **端口占用**：确保 3001 端口未被占用
3. **API Key**：必须配置智谱清言 API Key
4. **跨域**：后端已配置 CORS，可以本地调用

## 🛠️ 故障排除

### 后端启动失败
- 检查 Node.js 版本（建议 v16+）
- 检查端口 3001 是否被占用
- 检查 .env 文件是否存在

### 前端无法连接后端
- 确认后端正在运行
- 检查 .env.local 中的 VITE_LLM_API_ENDPOINT
- 查看浏览器控制台错误信息

### API 调用失败
- 检查智谱 API Key 是否正确
- 检查智谱账户是否有余额
- 查看后端终端的错误日志

## 📝 日志输出

后端会输出详细日志：
- 🤖 智谱AI响应
- 🖼️ 图片搜索结果
- ✅ 成功/失败状态

前端控制台会显示：
- 📊 加载的旅行数据
- 🖼️ 图片URL
- ❌ 错误信息
